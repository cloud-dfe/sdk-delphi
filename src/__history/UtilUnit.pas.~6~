unit UtilUnit;

interface

uses
  System.SysUtils, System.Classes, System.NetEncoding;

type
  TUtil = class
  public
    class function Encode(const Data: string): string;
    class function Decode(const Data: string): string;
    class function ReadFile(const FileName: string): string;
  end;

implementation

{ TUtil }

class function TUtil.Encode(const Data: string): string;
begin
  // Codifica a string em Base64
  Result := TNetEncoding.Base64.Encode(Data);
end;

class function TUtil.Decode(const Data: string): string;
var
  DecodedData: TBytes;
begin
  try
    // Decodifica os dados Base64 para bytes
    DecodedData := TNetEncoding.Base64.DecodeStringToBytes(Data);
    // Converte os bytes decodificados de volta para string UTF-8
    Result := TEncoding.UTF8.GetString(DecodedData);
  except
    on E: Exception do
      raise Exception.Create('Erro ao decodificar dados: ' + E.Message);
  end;
end;

class function TUtil.ReadFile(const FileName: string): string;
var
  FileStream: TFileStream;
begin
  try
    // Abre o arquivo para leitura
    FileStream := TFileStream.Create(FileName, fmOpenRead or fmShareDenyWrite);
    try
      SetLength(Result, FileStream.Size);
      FileStream.ReadBuffer(Result[1], FileStream.Size);
    finally
      FileStream.Free;
    end;
  except
    on E: Exception do
      raise Exception.Create('Erro ao ler o arquivo: ' + E.Message);
  end;
end;

end.

